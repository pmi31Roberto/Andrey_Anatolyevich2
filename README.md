# Лабораторная работа(1): Использование алгоритмов машинного обучения для предсказания финансовых рынков

Этот репозиторий содержит пример кода на Python для прогнозирования цен закрытия акций с использованием модели случайного леса.

## Обзор

Цель данного проекта заключается в создании модели машинного обучения для прогнозирования цен закрытия акций на основе исторических данных.


## Обучение

Использование модели случайного леса с 100 деревьями для обучения на обучающей выборке.


## Использование

Чтобы использовать этот код и провести эксперименты с различными функциями активации, выполните следующие шаги:

1. **Подготовьте данные:**

Замените 'your_data.csv' в строке data = pd.read_csv('/content/intraday_5min_IBM.csv') на путь к своему файлу данных. Убедитесь, что ваш файл данных содержит столбец временных меток (timestamp) и цены закрытия (close).

2. **Установите библиотеки:**
    Убедитесь, что у вас установлены необходимые библиотеки. Если их нет, вы можете установить их с помощью команды:
    ```bash
    pip install pandas scikit-learn matplotlib

    ```

3. **Запустите код:**
   Сохраните изменения в файле и запустите код. В результате выполнения кода будут обучена модель случайного леса на ваших данных, и вы получите оценку среднеквадратичной ошибки (MSE) и графики с фактическими и предсказанными ценами закрытия.

4. **Адаптируйте при необходимости:**
    В случае необходимости адаптируйте код под свой формат данных или измените параметры модели (например, количество деревьев в случайном лесе).

5. **Интерпретируйте результаты:**
    Изучите графики и оценку MSE, чтобы оценить качество предсказаний модели. Обратите внимание, что успешность прогнозирования может зависеть от множества факторов, включая качество данных и выбор признаков.
   
6. **Интегрируйте в свой проект:**
    После успешного тестирования и адаптации кода вы можете интегрировать его в свой проект для регулярного обновления прогнозов.



## Пример 
#Начальный датасет

![image](https://github.com/pmi31Roberto/Andrey_Anatolyevich2/assets/120023351/82d89604-c1ac-47b5-81f0-e6ed3c23aaf9)

#Преобразованный датасет
![image](https://github.com/pmi31Roberto/Andrey_Anatolyevich2/assets/120023351/efc3a48f-af77-4c1f-bede-bfaa1a9a3b6a)
##Построение графиков на основе преобразованного датасета

#График предсказаний:
![image](https://github.com/pmi31Roberto/Andrey_Anatolyevich2/assets/120023351/d0fb3485-6107-47ea-bf82-43fd6efc7f6c)
Синий график ("Actual Prices"): Показывает фактические цены закрытия (closing prices) на финансовом рынке в тестовом периоде.
Красный график ("Predicted Prices"): Отображает предсказанные моделью цены закрытия на том же тестовом периоде.
Название: "Stock Price Prediction with Random Forest".
Оси: Ось X представляет временные метки, а ось Y представляет цены закрытия.

#График остатков:
![image](https://github.com/pmi31Roberto/Andrey_Anatolyevich2/assets/120023351/23ac8431-2255-4a70-9d0d-6ec37d18e59d)

Зеленый график ("Residuals"): Показывает разницу между фактическими и предсказанными значениями (остатки).
Красная пунктирная линия ("Zero Residuals"): Представляет собой нулевую линию остатков. Она полезна для визуальной оценки, насколько хорошо модель предсказывает данные.
Название: "Residuals Plot".
Оси: Ось X представляет временные метки, а ось Y представляет остатки.
#График динамики цен закрытия со временем:
![image](https://github.com/pmi31Roberto/Andrey_Anatolyevich2/assets/120023351/d4e84c11-0e3e-489d-a85b-986a44f41ca3)

Синий график ("Closing Prices"): Показывает динамику цен закрытия на финансовом рынке в течение всего периода данных.
Название: "Closing Prices Over Time".
Оси: Ось X представляет временные метки, а ось Y представляет цены закрытия.
